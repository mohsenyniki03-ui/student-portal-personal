<!DOCTYPE html>
<html xmlns="http:/ /www.w3.org/1999/xhtml" xmlns:th="http:/ /www.thymeleaf.org">

<!-- <head>
    <title>cnnn</title>
</head> -->

<body style="position: relative; min-height: 100vh;">
    <!-- Top-right login / user info -->
    <div style="position: absolute; top: 12px; right: 12px; z-index: 1000;">
        <!-- show login when anonymous -->
        <div th:if="${currentUser == null}">
            <a th:href="@{/login}" style="text-decoration:none;">
                <button style="background:#17a2b8;color:white;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;">Login</button>
            </a>
        </div>

        <!-- show basic user info when authenticated -->
        <div th:if="${currentUser != null}" style="text-align: right; color: #222; background: rgba(255,255,255,0.8); padding:6px 10px; border-radius:6px;">
            <div style="font-weight:600;" th:text="${displayName}">Display Name</div>
            <div style="font-size:0.9em; color:#666;">@<span th:text="${currentUser}">username</span></div>
            <!-- logout form (Spring Security CSRF token supported if available) -->
            <form th:action="@{/logout}" method="post" style="margin-top:6px;">
                <!-- only include CSRF inputs when Spring Security has exposed the _csrf attribute -->
                <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" style="background:#e55353;color:white;border:none;padding:6px 8px;border-radius:5px;cursor:pointer;font-size:0.9em;">Logout</button>
            </form>
        </div>
    </div>

    <h1 style="text-align: center;">Schedule Your Courses With Us! </h1>
    <img th:src="@{/images/welcome.png}" width="500" style="display:block; margin:auto;">
    <!-- quick access buttons -->
    <div style="text-align: center; margin-top: 12px;">
        
        <!-- Access my schedule: goes to /schedule which we'll require authentication for -->
        <a th:href="@{/schedule}" style="margin-left: 10px; text-decoration:none;">
            <button style="background:#17a2b8;color:white;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;">Access my schedule</button>
        </a>
        <!-- Login moved to top-right corner -->
    </div>
    <form th:action="@{/search}" method="get" style="text-align: center; margin-top: 20px;">
        <input type="text" name="query" placeholder="Search for a course" style="width: 420px; height: 35px;">

        <!-- Campus Filter -->
        <select name="campus" style="height: 35px;">
            <option value="">All Campuses</option>
            <option value="Bloomington">Bloomington</option>
            <option value="Kokomo">Kokomo</option>
            <option value="Indianapolis">Indianapolis</option>
        </select>

        <!-- Semester Filter -->
        <select name="semester" style="height: 35px;">
            <option value="">All Semesters</option>
            <option value="Fall">Fall</option>
            <option value="Spring">Spring</option>
            <option value="Summer">Summer</option>
        </select>

        <button type="submit" style="width: max-content; height: 35px;">Search</button>
    </form>

    <div th:if="${error}" style="color: red; text-align: center;">
        <p th:text="${error}"></p>
    </div>

    <!-- Search Results Section -->
    <div th:if="${results}" style="margin-top: 30px; text-align: center;">
        <h3>Search Results:</h3>
        <ul style="list-style: none; padding: 0;">
            <li th:each="course : ${results}">
                <a th:href="@{'/courses/' + ${course.courseId}}">
                    <strong th:text="${course.courseId}"></strong>
                    <span th:text="${course.courseName}"></span> -
                </a>
                (<span th:text="${course.credits}"></span> credits) -
                <span th:text="${course.instructor}"></span> -
                <span th:text="${course.campusId}"></span> -
                <span th:text="${course.semester}"></span>
                <span th:text="${course.schedule}"></span>
                <form th:action="@{'/enroll/' + ${course.courseId}}" method="post" style="display:inline;">
                    <button type="submit" 
                        style="margin-left: 15px; background-color: #007BFF; color: white; border: none; 
                               padding: 5px 10px; border-radius: 5px; cursor: pointer;">
                        Enroll
                    </button>
                </form>
            </li>
        </ul>
    </div>

</body>

</html>